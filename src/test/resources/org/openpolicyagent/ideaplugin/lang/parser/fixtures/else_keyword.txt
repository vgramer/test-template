Rego File
  RegoPackageImpl(RegoElementType.PACKAGE)
    PsiElement(package)('package')
    PsiWhiteSpace(' ')
    RegoRefImpl(RegoElementType.REF)
      RegoVarImpl(RegoElementType.VAR)
        PsiElement(ASCII_LETTER)('main')
  PsiWhiteSpace('\n\n')
  PsiComment(COMMENT)('# In order to handle manifest with one or many resources, we turns the input into an array, if it's not an array already.')
  PsiWhiteSpace('\n')
  RegoPolicyImpl(RegoElementType.POLICY)
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('as_array')
        PsiElement(()('(')
        RegoRuleArgsImpl(RegoElementType.RULE_ARGS)
          RegoTermImpl(RegoElementType.TERM)
            RegoRefImpl(RegoElementType.REF)
              RegoVarImpl(RegoElementType.VAR)
                PsiElement(ASCII_LETTER)('x')
        PsiElement())(')')
        PsiWhiteSpace(' ')
        PsiElement(=)('=')
        PsiWhiteSpace(' ')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoArrayImpl(RegoElementType.ARRAY)
              PsiElement([)('[')
              RegoTermImpl(RegoElementType.TERM)
                RegoRefImpl(RegoElementType.REF)
                  RegoVarImpl(RegoElementType.VAR)
                    PsiElement(ASCII_LETTER)('x')
              PsiElement(])(']')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            PsiElement(not)('not')
            PsiWhiteSpace(' ')
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprCallImpl(RegoElementType.EXPR_CALL)
                  RegoVarImpl(RegoElementType.VAR)
                    PsiElement(ASCII_LETTER)('is_array')
                  PsiElement(()('(')
                  RegoTermOrInfixOpImpl(RegoElementType.TERM_OR_INFIX_OP)
                    RegoTermImpl(RegoElementType.TERM)
                      RegoRefImpl(RegoElementType.REF)
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('x')
                  PsiElement())(')')
        PsiElement(})('}')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement(else)('else')
        PsiWhiteSpace(' ')
        PsiElement(=)('=')
        PsiWhiteSpace(' ')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoVarImpl(RegoElementType.VAR)
              PsiElement(ASCII_LETTER)('x')
        PsiWhiteSpace(' ')
        PsiElement({)('{')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoScalarImpl(RegoElementType.SCALAR)
                    PsiElement(true)('true')
        PsiElement(})('}')