Rego File
  RegoPackageImpl(RegoElementType.PACKAGE)
    PsiElement(package)('package')
    PsiWhiteSpace(' ')
    RegoRefImpl(RegoElementType.REF)
      RegoVarImpl(RegoElementType.VAR)
        PsiElement(ASCII_LETTER)('play')
  PsiWhiteSpace('\n\n')
  RegoPolicyImpl(RegoElementType.POLICY)
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('sites')
        PsiWhiteSpace(' ')
        PsiElement(=)('=')
        PsiWhiteSpace(' ')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoArrayImpl(RegoElementType.ARRAY)
              PsiElement([)('[')
              PsiElement(])(']')
    PsiWhiteSpace('\n\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('labelrego')
        PsiElement([)('[')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoVarImpl(RegoElementType.VAR)
              PsiElement(ASCII_LETTER)('msg')
        PsiElement(])(']')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n    ')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprInfixImpl(RegoElementType.EXPR_INFIX)
                  RegoTermImpl(RegoElementType.TERM)
                    RegoRefImpl(RegoElementType.REF)
                      RegoVarImpl(RegoElementType.VAR)
                        PsiElement(ASCII_LETTER)('input')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('request')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('kind')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('kind')
                  PsiWhiteSpace(' ')
                  RegoInfixOperatorImpl(RegoElementType.INFIX_OPERATOR)
                    RegoBoolOperatorImpl(RegoElementType.BOOL_OPERATOR)
                      PsiElement(==)('==')
                  PsiWhiteSpace(' ')
                  RegoTermImpl(RegoElementType.TERM)
                    RegoScalarImpl(RegoElementType.SCALAR)
                      RegoStringImpl(RegoElementType.STRING)
                        PsiElement(STRING_TOKEN)('"Deployment"')
          PsiWhiteSpace('\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprInfixImpl(RegoElementType.EXPR_INFIX)
                  RegoTermImpl(RegoElementType.TERM)
                    RegoRefImpl(RegoElementType.REF)
                      RegoVarImpl(RegoElementType.VAR)
                        PsiElement(ASCII_LETTER)('input')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('request')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('operation')
                  PsiWhiteSpace(' ')
                  RegoInfixOperatorImpl(RegoElementType.INFIX_OPERATOR)
                    RegoBoolOperatorImpl(RegoElementType.BOOL_OPERATOR)
                      PsiElement(==)('==')
                  PsiWhiteSpace(' ')
                  RegoTermImpl(RegoElementType.TERM)
                    RegoScalarImpl(RegoElementType.SCALAR)
                      RegoStringImpl(RegoElementType.STRING)
                        PsiElement(STRING_TOKEN)('"CREATE"')
          PsiWhiteSpace('\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprInfixImpl(RegoElementType.EXPR_INFIX)
                  RegoTermImpl(RegoElementType.TERM)
                    RegoRefImpl(RegoElementType.REF)
                      RegoVarImpl(RegoElementType.VAR)
                        PsiElement(ASCII_LETTER)('input')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('request')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('namespace')
                  PsiWhiteSpace(' ')
                  RegoInfixOperatorImpl(RegoElementType.INFIX_OPERATOR)
                    RegoBoolOperatorImpl(RegoElementType.BOOL_OPERATOR)
                      PsiElement(==)('==')
                  PsiWhiteSpace(' ')
                  RegoTermImpl(RegoElementType.TERM)
                    RegoScalarImpl(RegoElementType.SCALAR)
                      RegoStringImpl(RegoElementType.STRING)
                        PsiElement(STRING_TOKEN)('"labeltest2"')
          PsiWhiteSpace('\n\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('invalid_label')
          PsiWhiteSpace('\n\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('namespace')
              PsiWhiteSpace(' ')
              PsiElement(=)('=')
              PsiWhiteSpace(' ')
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('input')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('request')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('namespace')
          PsiWhiteSpace('\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('msg')
              PsiWhiteSpace(' ')
              PsiElement(:=)(':=')
              PsiWhiteSpace(' ')
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprCallImpl(RegoElementType.EXPR_CALL)
                  RegoVarImpl(RegoElementType.VAR)
                    PsiElement(ASCII_LETTER)('sprintf')
                  PsiElement(()('(')
                  RegoTermOrInfixOpImpl(RegoElementType.TERM_OR_INFIX_OP)
                    RegoTermImpl(RegoElementType.TERM)
                      RegoScalarImpl(RegoElementType.SCALAR)
                        RegoStringImpl(RegoElementType.STRING)
                          PsiElement(STRING_TOKEN)('"[Deployment Rule]: Deployment Label is invalid or does not exist for namespace %q"')
                  PsiElement(,)(',')
                  PsiWhiteSpace(' ')
                  RegoTermOrInfixOpImpl(RegoElementType.TERM_OR_INFIX_OP)
                    RegoTermImpl(RegoElementType.TERM)
                      RegoRefImpl(RegoElementType.REF)
                        RegoArrayImpl(RegoElementType.ARRAY)
                          PsiElement([)('[')
                          RegoTermImpl(RegoElementType.TERM)
                            RegoRefImpl(RegoElementType.REF)
                              RegoVarImpl(RegoElementType.VAR)
                                PsiElement(ASCII_LETTER)('namespace')
                          PsiElement(])(']')
                  PsiElement())(')')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
    PsiWhiteSpace('\n\n')
    PsiComment(COMMENT)('# multiple rule bodies are an implicit "OR"')
    PsiWhiteSpace('\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('invalid_label')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n    ')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            PsiElement(not)('not')
            PsiWhiteSpace(' ')
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('has_contact_product_owner_label')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n\t')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            PsiElement(not)('not')
            PsiWhiteSpace(' ')
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('has_contact_product_dl_label')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
    PsiWhiteSpace('\n\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('has_contact_product_owner_label')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n\t')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('value')
              PsiWhiteSpace(' ')
              PsiElement(:=)(':=')
              PsiWhiteSpace(' ')
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('input')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('request')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('object')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('metadata')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          RegoStringImpl(RegoElementType.STRING)
                            PsiElement(STRING_TOKEN)('"labels"')
                        PsiElement(])(']')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          RegoStringImpl(RegoElementType.STRING)
                            PsiElement(STRING_TOKEN)('"contact.productowner"')
                        PsiElement(])(']')
          PsiWhiteSpace('\n\t')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprCallImpl(RegoElementType.EXPR_CALL)
                  RegoVarImpl(RegoElementType.VAR)
                    PsiElement(ASCII_LETTER)('re_match')
                  PsiElement(()('(')
                  RegoTermOrInfixOpImpl(RegoElementType.TERM_OR_INFIX_OP)
                    RegoTermImpl(RegoElementType.TERM)
                      RegoScalarImpl(RegoElementType.SCALAR)
                        RegoStringImpl(RegoElementType.STRING)
                          PsiElement(STRING_TOKEN)('"^.+_at_domain\\.com$"')
                  PsiElement(,)(',')
                  PsiWhiteSpace(' ')
                  RegoTermOrInfixOpImpl(RegoElementType.TERM_OR_INFIX_OP)
                    RegoTermImpl(RegoElementType.TERM)
                      RegoRefImpl(RegoElementType.REF)
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('value')
                  PsiElement())(')')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
    PsiWhiteSpace('\n\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('has_contact_product_dl_label')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n\t')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('value')
              PsiWhiteSpace(' ')
              PsiElement(:=)(':=')
              PsiWhiteSpace(' ')
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('input')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('request')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('object')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('metadata')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          RegoStringImpl(RegoElementType.STRING)
                            PsiElement(STRING_TOKEN)('"labels"')
                        PsiElement(])(']')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          RegoStringImpl(RegoElementType.STRING)
                            PsiElement(STRING_TOKEN)('"contact.dl"')
                        PsiElement(])(']')
          PsiWhiteSpace('\n\t')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprCallImpl(RegoElementType.EXPR_CALL)
                  RegoVarImpl(RegoElementType.VAR)
                    PsiElement(ASCII_LETTER)('re_match')
                  PsiElement(()('(')
                  RegoTermOrInfixOpImpl(RegoElementType.TERM_OR_INFIX_OP)
                    RegoTermImpl(RegoElementType.TERM)
                      RegoScalarImpl(RegoElementType.SCALAR)
                        RegoStringImpl(RegoElementType.STRING)
                          PsiElement(STRING_TOKEN)('"^.+_at_domain\\.com$"')
                  PsiElement(,)(',')
                  PsiWhiteSpace(' ')
                  RegoTermOrInfixOpImpl(RegoElementType.TERM_OR_INFIX_OP)
                    RegoTermImpl(RegoElementType.TERM)
                      RegoRefImpl(RegoElementType.REF)
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('value')
                  PsiElement())(')')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
    PsiWhiteSpace('\n\n\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('reference')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('sites')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          PsiElement(NUMBER)('0')
                        PsiElement(])(']')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          RegoStringImpl(RegoElementType.STRING)
                            PsiElement(STRING_TOKEN)('"servers"')
                        PsiElement(])(']')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          PsiElement(NUMBER)('1')
                        PsiElement(])(']')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoScalarImpl(RegoElementType.SCALAR)
                          RegoStringImpl(RegoElementType.STRING)
                            PsiElement(STRING_TOKEN)('"hostname"')
                        PsiElement(])(']')
        PsiWhiteSpace('\n')
        PsiElement(})('}')