Rego File
  RegoPackageImpl(RegoElementType.PACKAGE)
    PsiElement(package)('package')
    PsiWhiteSpace(' ')
    RegoRefImpl(RegoElementType.REF)
      RegoVarImpl(RegoElementType.VAR)
        PsiElement(ASCII_LETTER)('test')
  PsiWhiteSpace('\n\n')
  RegoPolicyImpl(RegoElementType.POLICY)
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('authorize')
        PsiWhiteSpace(' ')
        PsiElement(=)('=')
        PsiWhiteSpace(' ')
        RegoTermImpl(RegoElementType.TERM)
          RegoScalarImpl(RegoElementType.SCALAR)
            RegoStringImpl(RegoElementType.STRING)
              PsiElement(STRING_TOKEN)('"allow"')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n    ')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprInfixImpl(RegoElementType.EXPR_INFIX)
                  RegoTermImpl(RegoElementType.TERM)
                    RegoRefImpl(RegoElementType.REF)
                      RegoVarImpl(RegoElementType.VAR)
                        PsiElement(ASCII_LETTER)('input')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('user')
                  PsiWhiteSpace(' ')
                  RegoInfixOperatorImpl(RegoElementType.INFIX_OPERATOR)
                    RegoBoolOperatorImpl(RegoElementType.BOOL_OPERATOR)
                      PsiElement(==)('==')
                  PsiWhiteSpace(' ')
                  RegoTermImpl(RegoElementType.TERM)
                    RegoScalarImpl(RegoElementType.SCALAR)
                      RegoStringImpl(RegoElementType.STRING)
                        PsiElement(STRING_TOKEN)('"superuser"')
        PsiComment(COMMENT)('           # allow 'superuser' to perform any operation.')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement(else)('else')
        PsiWhiteSpace(' ')
        PsiElement(=)('=')
        PsiWhiteSpace(' ')
        RegoTermImpl(RegoElementType.TERM)
          RegoScalarImpl(RegoElementType.SCALAR)
            RegoStringImpl(RegoElementType.STRING)
              PsiElement(STRING_TOKEN)('"deny"')
        PsiWhiteSpace(' ')
        PsiElement({)('{')
        PsiWhiteSpace('\n    ')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprInfixImpl(RegoElementType.EXPR_INFIX)
                  RegoTermImpl(RegoElementType.TERM)
                    RegoRefImpl(RegoElementType.REF)
                      RegoVarImpl(RegoElementType.VAR)
                        PsiElement(ASCII_LETTER)('input')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('path')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                          PsiElement([)('[')
                          RegoScalarImpl(RegoElementType.SCALAR)
                            PsiElement(NUMBER)('0')
                          PsiElement(])(']')
                  PsiWhiteSpace(' ')
                  RegoInfixOperatorImpl(RegoElementType.INFIX_OPERATOR)
                    RegoBoolOperatorImpl(RegoElementType.BOOL_OPERATOR)
                      PsiElement(==)('==')
                  PsiWhiteSpace(' ')
                  RegoTermImpl(RegoElementType.TERM)
                    RegoScalarImpl(RegoElementType.SCALAR)
                      RegoStringImpl(RegoElementType.STRING)
                        PsiElement(STRING_TOKEN)('"admin"')
          PsiComment(COMMENT)('            # disallow 'admin' operations...')
          PsiWhiteSpace('\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoExprInfixImpl(RegoElementType.EXPR_INFIX)
                  RegoTermImpl(RegoElementType.TERM)
                    RegoRefImpl(RegoElementType.REF)
                      RegoVarImpl(RegoElementType.VAR)
                        PsiElement(ASCII_LETTER)('input')
                      RegoRefArgImpl(RegoElementType.REF_ARG)
                        RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                          PsiElement(.)('.')
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('source_network')
                  PsiWhiteSpace(' ')
                  RegoInfixOperatorImpl(RegoElementType.INFIX_OPERATOR)
                    RegoBoolOperatorImpl(RegoElementType.BOOL_OPERATOR)
                      PsiElement(==)('==')
                  PsiWhiteSpace(' ')
                  RegoTermImpl(RegoElementType.TERM)
                    RegoScalarImpl(RegoElementType.SCALAR)
                      RegoStringImpl(RegoElementType.STRING)
                        PsiElement(STRING_TOKEN)('"external"')
        PsiComment(COMMENT)('  # from external networks.')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
  PsiComment(COMMENT)(' # ... more rules')