Rego File
  RegoPackageImpl(RegoElementType.PACKAGE)
    PsiElement(package)('package')
    PsiWhiteSpace(' ')
    RegoRefImpl(RegoElementType.REF)
      RegoVarImpl(RegoElementType.VAR)
        PsiElement(ASCII_LETTER)('test')
  PsiWhiteSpace('\n\n')
  RegoPolicyImpl(RegoElementType.POLICY)
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('apps')
        PsiElement(:=)(':=')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoObjectImpl(RegoElementType.OBJECT)
              PsiElement({)('{')
              PsiElement(})('}')
    PsiWhiteSpace('\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('sites')
        PsiElement(:=)(':=')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoObjectImpl(RegoElementType.OBJECT)
              PsiElement({)('{')
              PsiElement(})('}')
    PsiWhiteSpace('\n\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('app_to_hostnames')
        PsiElement([)('[')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoVarImpl(RegoElementType.VAR)
              PsiElement(ASCII_LETTER)('app_name')
        PsiElement(])(']')
        PsiWhiteSpace(' ')
        PsiElement(=)('=')
        PsiWhiteSpace(' ')
        RegoTermImpl(RegoElementType.TERM)
          RegoRefImpl(RegoElementType.REF)
            RegoVarImpl(RegoElementType.VAR)
              PsiElement(ASCII_LETTER)('hostnames')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n    ')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('app')
              PsiWhiteSpace(' ')
              PsiElement(:=)(':=')
              PsiWhiteSpace(' ')
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('apps')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('_')
                        PsiElement(])(']')
          PsiWhiteSpace('\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('app_name')
              PsiWhiteSpace(' ')
              PsiElement(:=)(':=')
              PsiWhiteSpace(' ')
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('app')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                        PsiElement(.)('.')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('name')
          PsiWhiteSpace('\n    ')
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('hostnames')
              PsiWhiteSpace(' ')
              PsiElement(:=)(':=')
              PsiWhiteSpace(' ')
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoArrayComprImpl(RegoElementType.ARRAY_COMPR)
                      PsiElement([)('[')
                      RegoTermImpl(RegoElementType.TERM)
                        RegoRefImpl(RegoElementType.REF)
                          RegoVarImpl(RegoElementType.VAR)
                            PsiElement(ASCII_LETTER)('hostname')
                      PsiWhiteSpace(' ')
                      PsiElement(|)('|')
                      PsiWhiteSpace(' ')
                      RegoQueryImpl(RegoElementType.QUERY)
                        RegoLiteralImpl(RegoElementType.LITERAL)
                          RegoExprImpl(RegoElementType.EXPR)
                            RegoExpr2Impl(RegoElementType.EXPR_2)
                              RegoTermImpl(RegoElementType.TERM)
                                RegoRefImpl(RegoElementType.REF)
                                  RegoVarImpl(RegoElementType.VAR)
                                    PsiElement(ASCII_LETTER)('name')
                            PsiWhiteSpace(' ')
                            PsiElement(:=)(':=')
                            PsiWhiteSpace(' ')
                            RegoExpr2Impl(RegoElementType.EXPR_2)
                              RegoTermImpl(RegoElementType.TERM)
                                RegoRefImpl(RegoElementType.REF)
                                  RegoVarImpl(RegoElementType.VAR)
                                    PsiElement(ASCII_LETTER)('app')
                                  RegoRefArgImpl(RegoElementType.REF_ARG)
                                    RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                                      PsiElement(.)('.')
                                      RegoVarImpl(RegoElementType.VAR)
                                        PsiElement(ASCII_LETTER)('servers')
                                  RegoRefArgImpl(RegoElementType.REF_ARG)
                                    RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                                      PsiElement([)('[')
                                      RegoVarImpl(RegoElementType.VAR)
                                        PsiElement(ASCII_LETTER)('_')
                                      PsiElement(])(']')
                        PsiWhiteSpace('\n                            ')
                        RegoLiteralImpl(RegoElementType.LITERAL)
                          RegoExprImpl(RegoElementType.EXPR)
                            RegoExpr2Impl(RegoElementType.EXPR_2)
                              RegoTermImpl(RegoElementType.TERM)
                                RegoRefImpl(RegoElementType.REF)
                                  RegoVarImpl(RegoElementType.VAR)
                                    PsiElement(ASCII_LETTER)('s')
                            PsiWhiteSpace(' ')
                            PsiElement(:=)(':=')
                            PsiWhiteSpace(' ')
                            RegoExpr2Impl(RegoElementType.EXPR_2)
                              RegoTermImpl(RegoElementType.TERM)
                                RegoRefImpl(RegoElementType.REF)
                                  RegoVarImpl(RegoElementType.VAR)
                                    PsiElement(ASCII_LETTER)('sites')
                                  RegoRefArgImpl(RegoElementType.REF_ARG)
                                    RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                                      PsiElement([)('[')
                                      RegoVarImpl(RegoElementType.VAR)
                                        PsiElement(ASCII_LETTER)('_')
                                      PsiElement(])(']')
                                  RegoRefArgImpl(RegoElementType.REF_ARG)
                                    RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                                      PsiElement(.)('.')
                                      RegoVarImpl(RegoElementType.VAR)
                                        PsiElement(ASCII_LETTER)('servers')
                                  RegoRefArgImpl(RegoElementType.REF_ARG)
                                    RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                                      PsiElement([)('[')
                                      RegoVarImpl(RegoElementType.VAR)
                                        PsiElement(ASCII_LETTER)('_')
                                      PsiElement(])(']')
                        PsiWhiteSpace('\n                            ')
                        RegoLiteralImpl(RegoElementType.LITERAL)
                          RegoExprImpl(RegoElementType.EXPR)
                            RegoExpr2Impl(RegoElementType.EXPR_2)
                              RegoExprInfixImpl(RegoElementType.EXPR_INFIX)
                                RegoTermImpl(RegoElementType.TERM)
                                  RegoRefImpl(RegoElementType.REF)
                                    RegoVarImpl(RegoElementType.VAR)
                                      PsiElement(ASCII_LETTER)('s')
                                    RegoRefArgImpl(RegoElementType.REF_ARG)
                                      RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                                        PsiElement(.)('.')
                                        RegoVarImpl(RegoElementType.VAR)
                                          PsiElement(ASCII_LETTER)('name')
                                PsiWhiteSpace(' ')
                                RegoInfixOperatorImpl(RegoElementType.INFIX_OPERATOR)
                                  RegoBoolOperatorImpl(RegoElementType.BOOL_OPERATOR)
                                    PsiElement(==)('==')
                                PsiWhiteSpace(' ')
                                RegoTermImpl(RegoElementType.TERM)
                                  RegoRefImpl(RegoElementType.REF)
                                    RegoVarImpl(RegoElementType.VAR)
                                      PsiElement(ASCII_LETTER)('name')
                        PsiWhiteSpace('\n                            ')
                        RegoLiteralImpl(RegoElementType.LITERAL)
                          RegoExprImpl(RegoElementType.EXPR)
                            RegoExpr2Impl(RegoElementType.EXPR_2)
                              RegoTermImpl(RegoElementType.TERM)
                                RegoRefImpl(RegoElementType.REF)
                                  RegoVarImpl(RegoElementType.VAR)
                                    PsiElement(ASCII_LETTER)('hostname')
                            PsiWhiteSpace(' ')
                            PsiElement(:=)(':=')
                            PsiWhiteSpace(' ')
                            RegoExpr2Impl(RegoElementType.EXPR_2)
                              RegoTermImpl(RegoElementType.TERM)
                                RegoRefImpl(RegoElementType.REF)
                                  RegoVarImpl(RegoElementType.VAR)
                                    PsiElement(ASCII_LETTER)('s')
                                  RegoRefArgImpl(RegoElementType.REF_ARG)
                                    RegoRefArgDotImpl(RegoElementType.REF_ARG_DOT)
                                      PsiElement(.)('.')
                                      RegoVarImpl(RegoElementType.VAR)
                                        PsiElement(ASCII_LETTER)('hostname')
                      PsiElement(])(']')
        PsiWhiteSpace('\n')
        PsiElement(})('}')
    PsiWhiteSpace('\n\n')
    RegoRuleImpl(RegoElementType.RULE)
      RegoRuleHeadImpl(RegoElementType.RULE_HEAD)
        RegoVarImpl(RegoElementType.VAR)
          PsiElement(ASCII_LETTER)('aRule')
      PsiWhiteSpace(' ')
      RegoRuleBodyImpl(RegoElementType.RULE_BODY)
        PsiElement({)('{')
        PsiWhiteSpace('\n    ')
        RegoQueryImpl(RegoElementType.QUERY)
          RegoLiteralImpl(RegoElementType.LITERAL)
            RegoExprImpl(RegoElementType.EXPR)
              RegoExpr2Impl(RegoElementType.EXPR_2)
                RegoTermImpl(RegoElementType.TERM)
                  RegoRefImpl(RegoElementType.REF)
                    RegoVarImpl(RegoElementType.VAR)
                      PsiElement(ASCII_LETTER)('app_to_hostnames')
                    RegoRefArgImpl(RegoElementType.REF_ARG)
                      RegoRefArgBrackImpl(RegoElementType.REF_ARG_BRACK)
                        PsiElement([)('[')
                        RegoVarImpl(RegoElementType.VAR)
                          PsiElement(ASCII_LETTER)('app')
                        PsiElement(])(']')
        PsiWhiteSpace('\n')
        PsiElement(})('}')